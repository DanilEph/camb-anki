{"ast":null,"code":"var _jsxFileName = \"/Users/macbookpro/Documents/my-repository/web/cambridge-anki/extention/src/components/ContentEditable/ContentEditable.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useRef } from 'react';\nimport uniqid from 'uniqid';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ContentEditable = _ref => {\n  _s();\n\n  let {\n    children,\n    id: oldId,\n    component,\n    onContentChange = () => {},\n    onInput = () => {},\n    ...other\n  } = _ref;\n  const Component = component || 'div';\n  const refContentEditable = useRef();\n  const id = uniqid('content-editable-');\n\n  const setContent = (selector, newContent) => {\n    const element = document.querySelector(selector);\n\n    if (element) {\n      newContent.forEach(node => {\n        const wrapedNode = document.createElement('div');\n        wrapedNode.append(node);\n        element.appendChild(wrapedNode);\n      });\n    }\n  };\n\n  useEffect(() => {}, children);\n\n  const handleChange = e => {\n    var _e$currentTarget$chil, _e$currentTarget$chil2;\n\n    const imgMaxWidth = e.currentTarget.clientWidth - 30;\n    const allImg = e.currentTarget.getElementsByTagName('img');\n\n    for (let i = 0; i < allImg.length; i++) {\n      const img = allImg[i];\n      if (img.width > imgMaxWidth) img.width = imgMaxWidth;\n    }\n\n    let parsedNodes = [];\n    const firstText = (_e$currentTarget$chil = e.currentTarget.childNodes[0]) === null || _e$currentTarget$chil === void 0 ? void 0 : _e$currentTarget$chil.textContent;\n    const firstImg = ((_e$currentTarget$chil2 = e.currentTarget.children[0]) === null || _e$currentTarget$chil2 === void 0 ? void 0 : _e$currentTarget$chil2.tagName) === 'IMG' ? e.currentTarget.getElementsByTagName('img')[0].outerHTML : undefined;\n    const nodes = e.currentTarget.getElementsByTagName('div');\n    firstImg && parsedNodes.push(firstImg);\n    firstText && parsedNodes.push(firstText);\n\n    for (let i = 0; i < nodes.length; i++) {\n      var _currentNode$children, _currentNode$children2;\n\n      const currentNode = nodes[i];\n      let imgs = [];\n      let text;\n\n      if (((_currentNode$children = currentNode.children[0]) === null || _currentNode$children === void 0 ? void 0 : _currentNode$children.tagName) === 'BR' && currentNode.childElementCount === 1) {\n        continue;\n      } else if (((_currentNode$children2 = currentNode.children[0]) === null || _currentNode$children2 === void 0 ? void 0 : _currentNode$children2.tagName) === 'IMG') {\n        const imgElements = currentNode.getElementsByTagName('img'); // img = (currentImg?.outerHTML);\n\n        for (let i = 0; i < imgElements.length; i++) {\n          const img = imgElements[i];\n          if (img.width > imgMaxWidth) img.width = imgMaxWidth;\n          imgs.push(img.outerHTML);\n        }\n      } else if (currentNode.textContent) {\n        text = currentNode.textContent;\n      }\n\n      parsedNodes = [...parsedNodes, ...imgs];\n      text && parsedNodes.push(text);\n    }\n\n    onContentChange(parsedNodes);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Component, {\n    id: id,\n    contentEditable: true,\n    onInput: e => {\n      handleChange(e);\n      onInput(e);\n    },\n    ...other\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ContentEditable, \"92LYIQ4ulYqKBUMPhII7TtS9nV8=\");\n\n_c = ContentEditable;\nexport default ContentEditable;\n\nvar _c;\n\n$RefreshReg$(_c, \"ContentEditable\");","map":{"version":3,"names":["React","useEffect","useRef","uniqid","ContentEditable","children","id","oldId","component","onContentChange","onInput","other","Component","refContentEditable","setContent","selector","newContent","element","document","querySelector","forEach","node","wrapedNode","createElement","append","appendChild","handleChange","e","imgMaxWidth","currentTarget","clientWidth","allImg","getElementsByTagName","i","length","img","width","parsedNodes","firstText","childNodes","textContent","firstImg","tagName","outerHTML","undefined","nodes","push","currentNode","imgs","text","childElementCount","imgElements"],"sources":["/Users/macbookpro/Documents/my-repository/web/cambridge-anki/extention/src/components/ContentEditable/ContentEditable.tsx"],"sourcesContent":["import React, { FC, ReactNode, useEffect, useRef } from 'react';\nimport { Type } from 'typescript';\nimport uniqid from 'uniqid';\n\nexport type IContentEditableProps<T extends React.ElementType> = {\n  component?: T;\n  onContentChange?: (event: ReactNode[]) => void;\n} & React.ComponentPropsWithoutRef<T>;\n\nconst ContentEditable = <T extends React.ElementType = 'div',>({ children, id: oldId, component, onContentChange = () => {}, onInput = () => {}, ...other }: IContentEditableProps<T>) => {\n  const Component = component || 'div';\n  const refContentEditable = useRef<HTMLDivElement>();\n  const id = uniqid('content-editable-');\n\n  const setContent = (selector: string, newContent: string[]) => {\n    const element = document.querySelector(selector);\n    if (element) {\n      newContent.forEach((node) => {\n        const wrapedNode = document.createElement('div')\n        wrapedNode.append(node);\n        element.appendChild(wrapedNode);\n      })\n    }\n  }\n\n  useEffect(() => {\n\n  }, children)\n\n  const handleChange = (e: React.FormEvent<HTMLDivElement>) => {\n    const imgMaxWidth = e.currentTarget.clientWidth - 30;\n    const allImg = e.currentTarget.getElementsByTagName('img');\n    for (let i = 0; i < allImg.length; i++) {\n      const img = allImg[i];\n      if (img.width > imgMaxWidth) img.width = imgMaxWidth;\n    }\n\n    let parsedNodes: string[] = [];\n    const firstText = e.currentTarget.childNodes[0]?.textContent;\n    const firstImg = e.currentTarget.children[0]?.tagName === 'IMG' ? e.currentTarget.getElementsByTagName('img')[0].outerHTML : undefined;\n    const nodes = e.currentTarget.getElementsByTagName('div');\n    \n    firstImg && parsedNodes.push(firstImg);\n    firstText && parsedNodes.push(firstText);\n\n    for (let i = 0; i < nodes.length; i++) {\n      const currentNode = nodes[i];\n      let imgs: string[] = [];\n      let text: string | undefined;\n\n      if (currentNode.children[0]?.tagName === 'BR' && currentNode.childElementCount === 1) {\n        continue;\n      } else if (currentNode.children[0]?.tagName === 'IMG') {\n        const imgElements = currentNode.getElementsByTagName('img');\n        // img = (currentImg?.outerHTML);\n        for (let i = 0; i < imgElements.length; i++) {\n          const img = imgElements[i];\n          if (img.width > imgMaxWidth) img.width = imgMaxWidth;\n          imgs.push(img.outerHTML);\n        }\n      } else if (currentNode.textContent) {\n        text = currentNode.textContent;\n      }\n      parsedNodes = [...parsedNodes,  ...imgs];\n      text && parsedNodes.push(text);\n    }\n    onContentChange(parsedNodes);\n  }\n\n  return (\n    <Component\n      id={id}\n      contentEditable\n      onInput={(e) => {handleChange(e); onInput(e)}}\n      {...other}\n    />\n  )\n};\n\nexport default ContentEditable;"],"mappings":"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"},"metadata":{},"sourceType":"module"}