{"ast":null,"code":"// getCaretPosition: return [start, end] as offsets to elem.textContent that\n//   correspond to the selected portion of text\n//   (if start == end, caret is at given position and no text is selected)\nexport function getCaretPosition(elem){// node_walk: walk the element tree, stop when func(node) returns false\nfunction node_walk(node,func){var result=func(node);for(node=node.firstChild;result!==false&&node;node=node.nextSibling){result=node_walk(node,func);}return result;};var sel=window.getSelection();var cum_length=[0,0];if(sel.anchorNode==elem)cum_length=[sel.anchorOffset,sel.extentOffset];else{var nodes_to_find=[sel.anchorNode,sel.extentNode];if(!elem.contains(sel.anchorNode)||!elem.contains(sel.extentNode))return undefined;else{var found=[0,0];var i;node_walk(elem,function(node){for(i=0;i<2;i++){if(node==nodes_to_find[i]){found[i]=true;if(found[i==0?1:0])return false;// all done\n}}if(node.textContent&&!node.firstChild){for(i=0;i<2;i++){if(!found[i])cum_length[i]+=node.textContent.length;}}});cum_length[0]+=sel.anchorOffset;cum_length[1]+=sel.extentOffset;}}if(cum_length[0]<=cum_length[1])return cum_length;return[cum_length[1],cum_length[0]];}","map":{"version":3,"names":["getCaretPosition","elem","node_walk","node","func","result","firstChild","nextSibling","sel","window","getSelection","cum_length","anchorNode","anchorOffset","extentOffset","nodes_to_find","extentNode","contains","undefined","found","i","textContent","length"],"sources":["/Users/macbookpro/Documents/my-repository/web/cambridge-anki/extention/src/utils/helpers/getCaretPosition.js"],"sourcesContent":["// getCaretPosition: return [start, end] as offsets to elem.textContent that\n//   correspond to the selected portion of text\n//   (if start == end, caret is at given position and no text is selected)\nexport function getCaretPosition(elem) {\n  // node_walk: walk the element tree, stop when func(node) returns false\n  function node_walk(node, func) {\n    var result = func(node);\n    for(node = node.firstChild; result !== false && node; node = node.nextSibling)\n      result = node_walk(node, func);\n    return result;\n  };\n\n  var sel = window.getSelection();\n  var cum_length = [0, 0];\n\n  if(sel.anchorNode == elem)\n    cum_length = [sel.anchorOffset, sel.extentOffset];\n  else {\n    var nodes_to_find = [sel.anchorNode, sel.extentNode];\n    if(!elem.contains(sel.anchorNode) || !elem.contains(sel.extentNode))\n      return undefined;\n    else {\n      var found = [0,0];\n      var i;\n      node_walk(elem, function(node) {\n        for(i = 0; i < 2; i++) {\n          if(node == nodes_to_find[i]) {\n            found[i] = true;\n            if(found[i == 0 ? 1 : 0])\n              return false; // all done\n          }\n        }\n\n        if(node.textContent && !node.firstChild) {\n          for(i = 0; i < 2; i++) {\n            if(!found[i])\n              cum_length[i] += node.textContent.length;\n          }\n        }\n      });\n      cum_length[0] += sel.anchorOffset;\n      cum_length[1] += sel.extentOffset;\n    }\n  }\n  if(cum_length[0] <= cum_length[1])\n    return cum_length;\n  return [cum_length[1], cum_length[0]];\n}"],"mappings":"AAAA;AACA;AACA;AACA,MAAO,SAASA,iBAAT,CAA0BC,IAA1B,CAAgC,CACrC;AACA,QAASC,UAAT,CAAmBC,IAAnB,CAAyBC,IAAzB,CAA+B,CAC7B,GAAIC,OAAM,CAAGD,IAAI,CAACD,IAAD,CAAjB,CACA,IAAIA,IAAI,CAAGA,IAAI,CAACG,UAAhB,CAA4BD,MAAM,GAAK,KAAX,EAAoBF,IAAhD,CAAsDA,IAAI,CAAGA,IAAI,CAACI,WAAlE,EACEF,MAAM,CAAGH,SAAS,CAACC,IAAD,CAAOC,IAAP,CAAlB,CADF,CAEA,MAAOC,OAAP,CACD,EAED,GAAIG,IAAG,CAAGC,MAAM,CAACC,YAAP,EAAV,CACA,GAAIC,WAAU,CAAG,CAAC,CAAD,CAAI,CAAJ,CAAjB,CAEA,GAAGH,GAAG,CAACI,UAAJ,EAAkBX,IAArB,CACEU,UAAU,CAAG,CAACH,GAAG,CAACK,YAAL,CAAmBL,GAAG,CAACM,YAAvB,CAAb,CADF,IAEK,CACH,GAAIC,cAAa,CAAG,CAACP,GAAG,CAACI,UAAL,CAAiBJ,GAAG,CAACQ,UAArB,CAApB,CACA,GAAG,CAACf,IAAI,CAACgB,QAAL,CAAcT,GAAG,CAACI,UAAlB,CAAD,EAAkC,CAACX,IAAI,CAACgB,QAAL,CAAcT,GAAG,CAACQ,UAAlB,CAAtC,CACE,MAAOE,UAAP,CADF,IAEK,CACH,GAAIC,MAAK,CAAG,CAAC,CAAD,CAAG,CAAH,CAAZ,CACA,GAAIC,EAAJ,CACAlB,SAAS,CAACD,IAAD,CAAO,SAASE,IAAT,CAAe,CAC7B,IAAIiB,CAAC,CAAG,CAAR,CAAWA,CAAC,CAAG,CAAf,CAAkBA,CAAC,EAAnB,CAAuB,CACrB,GAAGjB,IAAI,EAAIY,aAAa,CAACK,CAAD,CAAxB,CAA6B,CAC3BD,KAAK,CAACC,CAAD,CAAL,CAAW,IAAX,CACA,GAAGD,KAAK,CAACC,CAAC,EAAI,CAAL,CAAS,CAAT,CAAa,CAAd,CAAR,CACE,MAAO,MAAP,CAAc;AACjB,CACF,CAED,GAAGjB,IAAI,CAACkB,WAAL,EAAoB,CAAClB,IAAI,CAACG,UAA7B,CAAyC,CACvC,IAAIc,CAAC,CAAG,CAAR,CAAWA,CAAC,CAAG,CAAf,CAAkBA,CAAC,EAAnB,CAAuB,CACrB,GAAG,CAACD,KAAK,CAACC,CAAD,CAAT,CACET,UAAU,CAACS,CAAD,CAAV,EAAiBjB,IAAI,CAACkB,WAAL,CAAiBC,MAAlC,CACH,CACF,CACF,CAfQ,CAAT,CAgBAX,UAAU,CAAC,CAAD,CAAV,EAAiBH,GAAG,CAACK,YAArB,CACAF,UAAU,CAAC,CAAD,CAAV,EAAiBH,GAAG,CAACM,YAArB,CACD,CACF,CACD,GAAGH,UAAU,CAAC,CAAD,CAAV,EAAiBA,UAAU,CAAC,CAAD,CAA9B,CACE,MAAOA,WAAP,CACF,MAAO,CAACA,UAAU,CAAC,CAAD,CAAX,CAAgBA,UAAU,CAAC,CAAD,CAA1B,CAAP,CACD"},"metadata":{},"sourceType":"module"}