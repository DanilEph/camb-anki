{"ast":null,"code":"var _jsxFileName = \"/Users/macbookpro/Documents/my-repository/web/cambridge-anki/extention/src/components/ContentEditable/ContentEditable.tsx\";\nimport React from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ContentEditable = _ref => {\n  let {\n    component,\n    onContentChange,\n    onInput = () => {},\n    ...other\n  } = _ref;\n  const Component = component || 'div';\n\n  const handleChange = e => {\n    var _e$currentTarget$chil, _e$currentTarget$chil2;\n\n    let parsedNodes = [];\n    const firstText = (_e$currentTarget$chil = e.currentTarget.childNodes[0]) === null || _e$currentTarget$chil === void 0 ? void 0 : _e$currentTarget$chil.textContent;\n    const firstImg = ((_e$currentTarget$chil2 = e.currentTarget.children[0]) === null || _e$currentTarget$chil2 === void 0 ? void 0 : _e$currentTarget$chil2.tagName) === 'IMG' ? e.currentTarget.getElementsByTagName('img')[0].outerHTML : undefined;\n    const nodes = e.currentTarget.getElementsByTagName('div');\n    const imgMaxWidth = e.currentTarget.clientWidth - 30;\n    console.log(firstImg);\n    firstText && parsedNodes.push(firstText);\n\n    for (let i = 0; i < nodes.length; i++) {\n      var _currentNode$children, _currentNode$children2;\n\n      const currentNode = nodes[i];\n      let img;\n      let text;\n\n      if (((_currentNode$children = currentNode.children[0]) === null || _currentNode$children === void 0 ? void 0 : _currentNode$children.tagName) === 'BR' && currentNode.childElementCount === 1) {\n        continue;\n      } else if (((_currentNode$children2 = currentNode.children[0]) === null || _currentNode$children2 === void 0 ? void 0 : _currentNode$children2.tagName) === 'IMG') {\n        const currentImg = currentNode.getElementsByTagName('img')[0];\n        console.log(currentImg === null || currentImg === void 0 ? void 0 : currentImg.width);\n        if ((currentImg === null || currentImg === void 0 ? void 0 : currentImg.width) > imgMaxWidth) currentImg.width = imgMaxWidth;\n        img = currentImg === null || currentImg === void 0 ? void 0 : currentImg.outerHTML; // for (let i = 0; i < imgElements.length; i++) {\n        //   const img = imgElements[i];\n        //   if (img.width > imgMaxWidth) img.width = imgMaxWidth;\n        //   imgs.push(img.outerHTML);\n        // }\n      } else if (currentNode.textContent) {\n        text = currentNode.textContent;\n      }\n\n      img && parsedNodes.push(img);\n      text && parsedNodes.push(text);\n    }\n\n    console.log(parsedNodes);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Component, {\n    contentEditable: true,\n    onInput: e => {\n      handleChange(e);\n      onInput(e);\n    },\n    ...other\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 5\n  }, this);\n};\n\n_c = ContentEditable;\nexport default ContentEditable;\n\nvar _c;\n\n$RefreshReg$(_c, \"ContentEditable\");","map":{"version":3,"names":["React","ContentEditable","component","onContentChange","onInput","other","Component","handleChange","e","parsedNodes","firstText","currentTarget","childNodes","textContent","firstImg","children","tagName","getElementsByTagName","outerHTML","undefined","nodes","imgMaxWidth","clientWidth","console","log","push","i","length","currentNode","img","text","childElementCount","currentImg","width"],"sources":["/Users/macbookpro/Documents/my-repository/web/cambridge-anki/extention/src/components/ContentEditable/ContentEditable.tsx"],"sourcesContent":["import React, { FC, ReactNode } from 'react';\nimport { Type } from 'typescript';\n\ntype IContentEditableProps<T extends React.ElementType> = {\n  component?: T;\n  onContentChange?: (event: ReactNode[]) => void;\n} & React.ComponentPropsWithoutRef<T>;\n\nconst ContentEditable = <T extends React.ElementType = 'div',>({ component, onContentChange, onInput = () => {}, ...other }: IContentEditableProps<T>) => {\n  const Component = component || 'div';\n\n  const handleChange = (e: React.FormEvent<HTMLDivElement>) => {\n    let parsedNodes: string[] = [];\n    const firstText = e.currentTarget.childNodes[0]?.textContent;\n    const firstImg = e.currentTarget.children[0]?.tagName === 'IMG' ? e.currentTarget.getElementsByTagName('img')[0].outerHTML : undefined;\n    const nodes = e.currentTarget.getElementsByTagName('div');\n    const imgMaxWidth = e.currentTarget.clientWidth - 30;\n    console.log(firstImg);\n    \n    firstText && parsedNodes.push(firstText);\n\n    for (let i = 0; i < nodes.length; i++) {\n      const currentNode = nodes[i];\n      let img: string | undefined;\n      let text: string | undefined;\n\n      if (currentNode.children[0]?.tagName === 'BR' && currentNode.childElementCount === 1) {\n        continue;\n      } else if (currentNode.children[0]?.tagName === 'IMG') {\n        const currentImg = currentNode.getElementsByTagName('img')[0];\n        console.log(currentImg?.width)\n        if (currentImg?.width > imgMaxWidth) currentImg.width = imgMaxWidth;\n        img = (currentImg?.outerHTML);\n        // for (let i = 0; i < imgElements.length; i++) {\n        //   const img = imgElements[i];\n        //   if (img.width > imgMaxWidth) img.width = imgMaxWidth;\n        //   imgs.push(img.outerHTML);\n        // }\n      } else if (currentNode.textContent) {\n        text = currentNode.textContent;\n      }\n      img && parsedNodes.push(img);\n      text && parsedNodes.push(text);\n    }\n    console.log(parsedNodes)\n  }\n\n  return (\n    <Component\n      contentEditable\n      onInput={(e) => {handleChange(e); onInput(e)}}\n      {...other}\n    />\n  )\n};\n\nexport default ContentEditable;"],"mappings":";AAAA,OAAOA,KAAP,MAAqC,OAArC;;;AAQA,MAAMC,eAAe,GAAG,QAAkI;EAAA,IAA3F;IAAEC,SAAF;IAAaC,eAAb;IAA8BC,OAAO,GAAG,MAAM,CAAE,CAAhD;IAAkD,GAAGC;EAArD,CAA2F;EACxJ,MAAMC,SAAS,GAAGJ,SAAS,IAAI,KAA/B;;EAEA,MAAMK,YAAY,GAAIC,CAAD,IAAwC;IAAA;;IAC3D,IAAIC,WAAqB,GAAG,EAA5B;IACA,MAAMC,SAAS,4BAAGF,CAAC,CAACG,aAAF,CAAgBC,UAAhB,CAA2B,CAA3B,CAAH,0DAAG,sBAA+BC,WAAjD;IACA,MAAMC,QAAQ,GAAG,2BAAAN,CAAC,CAACG,aAAF,CAAgBI,QAAhB,CAAyB,CAAzB,mFAA6BC,OAA7B,MAAyC,KAAzC,GAAiDR,CAAC,CAACG,aAAF,CAAgBM,oBAAhB,CAAqC,KAArC,EAA4C,CAA5C,EAA+CC,SAAhG,GAA4GC,SAA7H;IACA,MAAMC,KAAK,GAAGZ,CAAC,CAACG,aAAF,CAAgBM,oBAAhB,CAAqC,KAArC,CAAd;IACA,MAAMI,WAAW,GAAGb,CAAC,CAACG,aAAF,CAAgBW,WAAhB,GAA8B,EAAlD;IACAC,OAAO,CAACC,GAAR,CAAYV,QAAZ;IAEAJ,SAAS,IAAID,WAAW,CAACgB,IAAZ,CAAiBf,SAAjB,CAAb;;IAEA,KAAK,IAAIgB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGN,KAAK,CAACO,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;MAAA;;MACrC,MAAME,WAAW,GAAGR,KAAK,CAACM,CAAD,CAAzB;MACA,IAAIG,GAAJ;MACA,IAAIC,IAAJ;;MAEA,IAAI,0BAAAF,WAAW,CAACb,QAAZ,CAAqB,CAArB,iFAAyBC,OAAzB,MAAqC,IAArC,IAA6CY,WAAW,CAACG,iBAAZ,KAAkC,CAAnF,EAAsF;QACpF;MACD,CAFD,MAEO,IAAI,2BAAAH,WAAW,CAACb,QAAZ,CAAqB,CAArB,mFAAyBC,OAAzB,MAAqC,KAAzC,EAAgD;QACrD,MAAMgB,UAAU,GAAGJ,WAAW,CAACX,oBAAZ,CAAiC,KAAjC,EAAwC,CAAxC,CAAnB;QACAM,OAAO,CAACC,GAAR,CAAYQ,UAAZ,aAAYA,UAAZ,uBAAYA,UAAU,CAAEC,KAAxB;QACA,IAAI,CAAAD,UAAU,SAAV,IAAAA,UAAU,WAAV,YAAAA,UAAU,CAAEC,KAAZ,IAAoBZ,WAAxB,EAAqCW,UAAU,CAACC,KAAX,GAAmBZ,WAAnB;QACrCQ,GAAG,GAAIG,UAAJ,aAAIA,UAAJ,uBAAIA,UAAU,CAAEd,SAAnB,CAJqD,CAKrD;QACA;QACA;QACA;QACA;MACD,CAVM,MAUA,IAAIU,WAAW,CAACf,WAAhB,EAA6B;QAClCiB,IAAI,GAAGF,WAAW,CAACf,WAAnB;MACD;;MACDgB,GAAG,IAAIpB,WAAW,CAACgB,IAAZ,CAAiBI,GAAjB,CAAP;MACAC,IAAI,IAAIrB,WAAW,CAACgB,IAAZ,CAAiBK,IAAjB,CAAR;IACD;;IACDP,OAAO,CAACC,GAAR,CAAYf,WAAZ;EACD,CAlCD;;EAoCA,oBACE,QAAC,SAAD;IACE,eAAe,MADjB;IAEE,OAAO,EAAGD,CAAD,IAAO;MAACD,YAAY,CAACC,CAAD,CAAZ;MAAiBJ,OAAO,CAACI,CAAD,CAAP;IAAW,CAF/C;IAAA,GAGMH;EAHN;IAAA;IAAA;IAAA;EAAA,QADF;AAOD,CA9CD;;KAAMJ,e;AAgDN,eAAeA,eAAf"},"metadata":{},"sourceType":"module"}